### Linux文件权限介绍

当我们在一个目录下下达【ls -l】指令时，会得到以下格式输出

              连接数        群组         修改时间
    -rwxrwxr--  1   root   root  470  二月 24 14:49   sh01.sh
     文件属性        拥有者        容量                 文件名

这次重点介绍【文件属性】，【拥有者】和【群组】

#### 文件属性

上面第一列代表这个文件的属性，仔细看发现它共有十个属性：

    - rwx rwx r--

* 第一栏属性代表这个文件是【目录？文件或连接文件等等】
    * 当为【d】则是目录
    * 当为【-】则是文件
    * 若是【l】则表示为连接档（link file）
    * 若是【b】则表示为装置文件里面的可供存储的接口设备
    * 若是【c】则表示为装置文件里面的串行端口设备，例如键盘，鼠标
    * 接下来的属性中，三个为一组，且均为【rwx】三个参数的组合，其中【r】代表可读（read）,【w】代表可写（write）,【x】代表可执行（execute）
        * 第一组为【拥有者的权限】，如上面的示例中，该文件的拥有者可以读，写和执行该文件
        * 第二组为【同群组的权限】
        * 第三组为【其他非本群组的权限】

需要留意下当是一个目录时，x这个权限的作用，例如下面的示例：

    drwx------ 3 root root 4096 Jun 25 08:35 .ssh

请问非root的其他人是否可以进入该目录了？

答案是否定的，非root的其他人均不可进入.shh这个目录，为什么呢？因为x与目录的关系相当的重要，如果你在该目录地下不能执行任何执行的话，那么自然也就无法进入该目录了。`因此，请特别留意的是，如果你想要开放某个目录让一些人进来的话，请记得将该目录的x属性开发给别人哦`

* 第二栏表示为连接占用的节点，这个跟连接文件比较有关系
* 第三栏表示这个文件/目录的【拥有者】
* 第四栏表示拥有者的群组
    * 在Linux中，你的ID就是你的身份，而且你还可以附属在一个或多个群组之下，例如刚刚我们上面提到的，你有一个团体，代号为testgroup，且这个群体里面有三个人，其代号分别是test1,test2,test3，则这三个人为同一群组即testgroup.
* 第五栏为这个文件/目录的容量大小
* 第六栏为这个文件/目录的创建日期或者是最近的修改日期
* 第七栏为这个文件/目录的名称，如果名称前多一个【.】，则代表这个文件为【隐藏文件】

#### 如何改变档案权限

档案的权限对于系统安全至关重要，那么如何修改一个档案的权限呢？其实一个档案的权限有很多，大致上我们先介绍几个简单的，例如：群组，拥有者，各种身份的权限等等

* chgrp 改变档案所属群组
* chown 改变档案所属人
* chmod 改变档案的属性，SUID等等的特性

##### 改变所属群组 chgrp

chgrp就是将档案从一个群组改变属于另外一个群组；不过，请记住，要改变成为的群组名称必须要在/etc/group里面存在名称才行，否则就会显示错误！

语法

    [root@linux~]# chgrp [-R] dirname/filename ...

    -R  #进行递归(recursive)的持续变更，亦即连同次目录下的所有档案，目录都更新成为这个群组之意，常常用在变更某一目录的情况下

##### 改变档案拥有者 chown

如何改变一个档案的拥有者呢？很简单啊，既然改变群组是change group,那么改变拥有者就是change owner喽，也就是chown；要注意的是，拥有者必须是已经存在系统中的，也就是在/etc/passwd这个档案中有记录的拥有者才可以改变

chown的用途还蛮多的，除了可以改变档案的拥有者，它还可以改变档案的群组；如果要连目录下的所有目录和文件同时更改档案拥有者的话，直接加上-R的参数即可

语法

    [root@linux~]# chown [-R] [OWNER][:[GROUP]] dirname/filename...

说明：
* 如果只是给定owner参数，那么每个档案的owner都改变，但group不变
* 如果owner后面紧跟冒号（:）并给定一个group，且这三者之间没有空格，那么除了owner改变外，档案的group也会改变
* 如果冒号（:）后面没有紧跟group，那么档案的群组变得与【当前登录者】所属群组一样
* 如果冒号（:）和group给出，但是owner没有给，那么只有档案的group改变，这与使用chgrp的效果一样
* 如果只是给了冒号（:），或者owner,冒号（:）group三个参数都没给，那么档案的owner和group不会改变

##### 改变九个属性 chmod

档案属性的改变使用的是chmod这个指令，但是，属性的设定方法有两种，分别可以使用数字或者是符号来进行属性的变更

###### 数字类型改变档案权限

Linux档案的基本属性就有9个，分别是owner/group/others组的read/write/excute属性，这九个属性是三个三个一组的，其中，我们可以使用数字来代表各个属性，各属性的对照表如下：
* r : 4
* w : 2
* x : 1

同一组（owner/group/others）的三个属性（r/w/x）是需要累加的，例如当属性为【-rwxrwx---】，则是：
* owner = rwx=4+2+1=7
* group = rwx=4+2+1=7
* others = ---=0+0+0=0

所以等一下我们设定属性的变更时，该属性的数字就是770啦！

语法

    [root@linux~]# chmod [-R] xyz dirname/filename

    xyz #就是刚刚提到的数字类型的权限属性，为rwx属性数值的相加
    -R  #进行递归（recursive）的持续变更，亦即连同次目录下的所有文件，目录都更新成为这个群组之意，常常用在变更某一目录的情况

###### 符号类型改变档案权限

还有一个改变属性的方法，从之前的介绍中我们发现，基本上就九个属性分别是1）user 2)group 3)others三个，那么我们就可以由u,g,o来代表三种类型的属性；此外，a代表all亦即全部的三种类型，那么读写和执行属性就可以写成r,w,x喽；也就是可以使用底下的方式来看
![](https://github.com/yangguangyong/yangguangyong.github.io/blob/master/assets/2016/02/chmod.png)

来实际操作一下吧，假如我们要【设定】一个档案的属性为【-rwxr-xr-x】时，基本上就是：
* user(u): 具有可读，可写，可执行的权限
* group与others(g/o): 具有可读与执行的权限

所以就是：

    [root@linux~]# chmod u=rwx,go=rx .bashrc
    #注意，那个u=rwx,go=rx是连在一起的，中间并没有任何空格符号

此外，如果我不知道原先的档案属性，而我只想要增加.bashrc这个档案的每个人均可写入的权限，那么我就可以使用：

    [root@linux~]# chmod a+w .bashrc

而如果是要将属性去掉而不更改其他的属性了？例如要拿到所有人的x属性，则

    [root@linux~]# chmod a-x .bashrc

##### 目录属性的意义

刚刚上面介绍的属性几乎都是针对一般档案的特性在说明，那么如果是针对目录时，那个r,w,x对目录是什么意义呢？简单的说：
* r(read contents in directory): 表示具有读取目录结构清单的权限，所有当你具有读取（r）一个目录的权限时，你就可以利用ls这个指令将该目录的内容列表显示出来
* w(modify contents of directory): 这个可写入的权限对于目录来说，是很了不起的，因为它表示你将具有移动该目录结构清单的权限，也就是底下这些权限：
    * 建立新的档案与目录
    * 删除已经存在的档案与目录（不论该档案是属于谁的）
    * 将已存在的档案或目录进行更名
    * 搬移该目录内的档案，目录位置
* x(access directory): 这个x与能够进入该目录有关
